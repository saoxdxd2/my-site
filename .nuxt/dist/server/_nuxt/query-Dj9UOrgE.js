import{withBase as e,withLeadingSlash as r,joinURL as t,withoutTrailingSlash as s}from"C:/Users/sao/Documents/my-site/node_modules/ufo/dist/index.mjs";import{hash as n}from"C:/Users/sao/Documents/my-site/node_modules/ohash/dist/index.mjs";import"vue";import"C:/Users/sao/Documents/my-site/node_modules/klona/dist/index.mjs";import{b as o,g as i}from"../server.mjs";import{u as a}from"./preview-C8Om5VAN.js";const u=(e,r)=>r.split(".").reduce((e,r)=>e&&e[r],e),c=(e,r)=>Object.keys(e).filter(r).reduce((r,t)=>Object.assign(r,{[t]:e[t]}),{}),l=e=>r=>e&&e.length?c(r,r=>!e.includes(r)):r,p=e=>r=>Array.isArray(r)?r.map(r=>e(r)):e(r),h=e=>{const r=[],t=[];for(const s of e)["$","_"].includes(s)?r.push(s):t.push(s);return{prefixes:r,properties:t}},f=(e=[])=>r=>{if(0===e.length||!r)return r;const{prefixes:t,properties:s}=h(e);return c(r,e=>!s.includes(e)&&!t.includes(e[0]))},d=(e=[])=>r=>{if(0===e.length||!r)return r;const{prefixes:t,properties:s}=h(e);return c(r,e=>s.includes(e)||t.includes(e[0]))},m=(e,r)=>{const t=new Intl.Collator(r.$locale,{numeric:r.$numeric,caseFirst:r.$caseFirst,sensitivity:r.$sensitivity}),s=Object.keys(r).filter(e=>!e.startsWith("$"));for(const n of s)e=e.sort((e,s)=>{const o=[u(e,n),u(s,n)].map(e=>{if(null!==e)return e instanceof Date?e.toISOString():e});return-1===r[n]&&o.reverse(),t.compare(o[0],o[1])});return e},y=(e,r="Expected an array")=>{if(!Array.isArray(e))throw new TypeError(r)},w=e=>Array.isArray(e)?e:[void 0,null].includes(e)?[]:[e],g=["sort","where","only","without"];function $(e,r={}){const t={};for(const i of Object.keys(r.initialParams||{}))t[i]=g.includes(i)?w(r.initialParams[i]):r.initialParams[i];const s=(e,r=e=>e)=>(...s)=>(t[e]=r(...s),o),n=e=>r.legacy?e?.surround?e.surround:e?(e?.dirConfig&&(e.result={_path:e.dirConfig?._path,...e.result,_dir:e.dirConfig}),e?._path||Array.isArray(e)||!Object.prototype.hasOwnProperty.call(e,"result")?e:e?.result):e:e,o={params:()=>({...t,...t.where?{where:[...w(t.where)]}:{},...t.sort?{sort:[...w(t.sort)]}:{}}),only:s("only",w),without:s("without",w),where:s("where",e=>[...w(t.where),...w(e)]),sort:s("sort",e=>[...w(t.sort),...w(e)]),limit:s("limit",e=>parseInt(String(e),10)),skip:s("skip",e=>parseInt(String(e),10)),find:()=>e(o).then(n),findOne:()=>e(s("first")(!0)).then(n),count:()=>e(s("count")(!0)).then(n),locale:e=>o.where({_locale:e}),withSurround:s("surround",(e,r)=>({query:e,...r})),withDirConfig:()=>s("dirConfig")(!0)};return r.legacy?(o.findSurround=(e,r)=>o.withSurround(e,r).find().then(n),o):o}function b(e){return JSON.stringify(e,j)}function j(e,r){return r instanceof RegExp?`--REGEX ${r.toString()}`:r}const _=e=>{let r=b(e);r="undefined"!=typeof Buffer?Buffer.from(r).toString("base64"):btoa(r),r=r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return(r.match(/.{1,100}/g)||[]).join("/")},x=r=>e(r,o().public.content.api.baseURL),C=()=>{throw new Error("useContent is only accessible when you are using `documentDriven` mode.")},v=e=>{const r=i();r&&r.node.res.setHeader("x-nitro-prerender",[r.node.res.getHeader("x-nitro-prerender"),e].filter(Boolean).join(","))},E=()=>{const{experimental:e}=o().public.content;return!1};function O(e,...i){const{content:u}=o().public,c=$(async e=>{const{content:r}=o().public,t=e.params(),s=r.experimental.stripQueryParameters?x(`/query/${n(t)}.${r.integrity}/${_(t)}.json`):x(`/query/${n(t)}.${r.integrity}.json`);if(v(s),E())return(await import("./client-db-CqP39rKe.js").then(e=>e.useContentDatabase())).fetch(e);const i=await $fetch(s,{method:"GET",responseType:"json",params:r.experimental.stripQueryParameters?void 0:{_params:b(t),previewToken:a().getPreviewToken()}});if("string"==typeof i&&i.startsWith("<!DOCTYPE html>"))throw new Error("Not found");return i},{initialParams:"string"!=typeof e?e:{},legacy:!0});let l;"string"==typeof e&&(l=r(t(e,...i)));const p=c.params;return c.params=()=>{const e=p();if(l&&(e.where=e.where||[],e.first&&0===(e.where||[]).length?e.where.push({_path:s(l)}):e.where.push({_path:new RegExp(`^${l.replace(/[-[\]{}()*+.,^$\s/]/g,"\\$&")}`)})),e.sort?.length||(e.sort=[{_stem:1,$numeric:!0}]),u.locales.length){const r=e.where?.find(e=>e._locale)?._locale;r||(e.where=e.where||[],e.where.push({_locale:u.defaultLocale}))}return e},c}export{v as a,w as b,y as c,p as d,_ as e,m as f,u as g,f as h,d as i,b as j,$ as k,l as o,O as q,E as s,C as u,x as w};
//# sourceMappingURL=query-Dj9UOrgE.js.map
