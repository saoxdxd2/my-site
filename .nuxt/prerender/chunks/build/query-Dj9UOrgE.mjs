import{withBase as e,withLeadingSlash as r,joinURL as t,withoutTrailingSlash as n}from"file://C:/Users/sao/Documents/my-site/node_modules/ufo/dist/index.mjs";import{hash as o}from"file://C:/Users/sao/Documents/my-site/node_modules/ohash/dist/index.mjs";import{b as i,g as s}from"./server.mjs";import{v as a}from"./preview-C8Om5VAN.mjs";const w=e=>Array.isArray(e)?e:[void 0,null].includes(e)?[]:[e],l=["sort","where","only","without"];function b(e){return JSON.stringify(e,j)}function j(e,r){return r instanceof RegExp?`--REGEX ${r.toString()}`:r}const _=e=>{let r=b(e);return r="undefined"!=typeof Buffer?Buffer.from(r).toString("base64"):btoa(r),r=r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),(r.match(/.{1,100}/g)||[]).join("/")},x=r=>e(r,i().public.content.api.baseURL),C=()=>{throw new Error("useContent is only accessible when you are using `documentDriven` mode.")},v=e=>{const r=s();r&&r.node.res.setHeader("x-nitro-prerender",[r.node.res.getHeader("x-nitro-prerender"),e].filter(Boolean).join(","))},E=()=>{const{experimental:e}=i().public.content;return!1};function O(e,...s){const{content:u}=i().public,c=function(e,r={}){const t={};for(const e of Object.keys(r.initialParams||{}))t[e]=l.includes(e)?w(r.initialParams[e]):r.initialParams[e];const s2=(e,r=e=>e)=>(...o)=>(t[e]=r(...o),n),n2=e=>{var t;return r.legacy?(null==e?void 0:e.surround)?e.surround:e?((null==e?void 0:e.dirConfig)&&(e.result={_path:null==(t=e.dirConfig)?void 0:t._path,...e.result,_dir:e.dirConfig}),(null==e?void 0:e._path)||Array.isArray(e)||!Object.prototype.hasOwnProperty.call(e,"result")?e:null==e?void 0:e.result):e:e},n={params:()=>({...t,...t.where?{where:[...w(t.where)]}:{},...t.sort?{sort:[...w(t.sort)]}:{}}),only:s2("only",w),without:s2("without",w),where:s2("where",e=>[...w(t.where),...w(e)]),sort:s2("sort",e=>[...w(t.sort),...w(e)]),limit:s2("limit",e=>parseInt(String(e),10)),skip:s2("skip",e=>parseInt(String(e),10)),find:()=>e(n).then(n2),findOne:()=>e(s2("first")(!0)).then(n2),count:()=>e(s2("count")(!0)).then(n2),locale:e=>n.where({_locale:e}),withSurround:s2("surround",(e,r)=>({query:e,...r})),withDirConfig:()=>s2("dirConfig")(!0)};return r.legacy?(n.findSurround=(e,r)=>n.withSurround(e,r).find().then(n2),n):n}(async e=>{const{content:r}=i().public,t=e.params(),n=r.experimental.stripQueryParameters?x(`/query/${o(t)}.${r.integrity}/${_(t)}.json`):x(`/query/${o(t)}.${r.integrity}.json`);v(n),E();const s=await $fetch(n,{method:"GET",responseType:"json",params:r.experimental.stripQueryParameters?void 0:{_params:b(t),previewToken:a().getPreviewToken()}});if("string"==typeof s&&s.startsWith("<!DOCTYPE html>"))throw new Error("Not found");return s},{initialParams:"string"!=typeof e?e:{},legacy:!0});let p;"string"==typeof e&&(p=r(t(e,...s)));const d=c.params;return c.params=()=>{var e,r,t;const o=d();if(p&&(o.where=o.where||[],o.first&&0===(o.where||[]).length?o.where.push({_path:n(p)}):o.where.push({_path:new RegExp(`^${p.replace(/[-[\]{}()*+.,^$\s/]/g,"\\$&")}`)})),(null==(e=o.sort)?void 0:e.length)||(o.sort=[{_stem:1,$numeric:!0}]),u.locales.length){(null==(t=null==(r=o.where)?void 0:r.find(e=>e._locale))?void 0:t._locale)||(o.where=o.where||[],o.where.push({_locale:u.defaultLocale}))}return o},c}export{C,E,O,_,b,v,x};
//# sourceMappingURL=query-Dj9UOrgE.mjs.map
