import{defineEventHandler as e,readBody as s,createError as t}from"file://C:/Users/sao/Documents/my-site/node_modules/h3/dist/index.mjs";const a=e(async e=>{try{const a=await s(e),{name:n,email:r,message:i,subject:m}=a;if(!n||!r||!i)throw t({statusCode:400,statusMessage:"Missing required fields: name, email, and message are required"});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r))throw t({statusCode:400,statusMessage:"Invalid email format"});const u=getClientIP(e)||"unknown",l=await async function(e){const s=Date.now(),t=9e5,a=5,n=o.get(e);if(!n||s>n.resetTime)return o.set(e,{count:1,resetTime:s+t}),{allowed:!0,remaining:a-1};if(n.count>=a)return{allowed:!1,remaining:0};return n.count++,{allowed:!0,remaining:a-n.count}}(u);if(!l.allowed)throw t({statusCode:429,statusMessage:"Too many requests. Please try again later."});return console.log("Contact form submission:",{name:n,email:r,subject:m||"Contact Form Submission",message:i,timestamp:(new Date).toISOString(),ip:u}),{success:!0,message:"Thank you for your message. We will get back to you soon!"}}catch(e){if(console.error("Contact form error:",e),e.statusCode)throw e;throw t({statusCode:500,statusMessage:"Internal server error. Please try again later."})}}),o=new Map;setInterval(()=>{const e=Date.now();for(const[s,t]of o.entries())e>t.resetTime&&o.delete(s)},3e5);export{a as default};
//# sourceMappingURL=contact.post.mjs.map
