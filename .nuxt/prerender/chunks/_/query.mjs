import{getQuery as e,createError as t}from"file://C:/Users/sao/Documents/my-site/node_modules/h3/dist/index.mjs";function regExpReviver(e,t){const r="string"==typeof t&&t.match(/^--([A-Z]+) (.+)$/)||[];if("REGEX"===r[1]){const e=r[2]?.match(/\/(.*)\/([dgimsuy]*)$/);return e?.[1]?new RegExp(e[1],e[2]||""):t}return t}const parseJSONQueryParams=e=>{try{return r=e,JSON.parse(r,regExpReviver)}catch{throw t({statusCode:400,message:"Invalid _params query"})}var r},decodeQueryParams=e=>(e=(e=(e=e.replace(/\//g,"")).replace(/-/g,"+").replace(/_/g,"/")).padEnd(e.length+(4-e.length%4)%4,"="),parseJSONQueryParams("undefined"!=typeof Buffer?Buffer.from(e,"base64").toString():atob(e))),r={},getContentQuery=t=>{const{params:s}=t.context.params||{};if(s)return decodeQueryParams(s.replace(/.json$/,""));const n=t.context.params?.qid?.replace(/.json$/,""),o=e(t)||{};if(n&&o._params)return r[n]=parseJSONQueryParams(decodeURIComponent(o._params)),r[n]?.where&&!Array.isArray(r[n]?.where)&&(r[n].where=[r[n].where]),r[n];if(n&&r[n])return r[n];if(o._params)return parseJSONQueryParams(decodeURIComponent(o._params));"string"==typeof o.only&&o.only.includes(",")&&(o.only=o.only.split(",").map(e=>e.trim())),"string"==typeof o.without&&o.without.includes(",")&&(o.without=o.without.split(",").map(e=>e.trim()));const a=o.where||{};for(const e of["draft","partial","empty"])o[e]&&["true","false"].includes(o[e])&&(a[e]="true"===o[e],delete o[e]);o.sort&&(o.sort=String(o.sort).split(",").map(e=>{const[t,r]=e.split(":");return[t,Number.parseInt(r||"0",10)]}));const i=["partial","draft","only","without","where","sort","limit","skip"];for(const e of Object.keys(o))i.includes(e)||(o.where=o.where||{},o.where[e]=o[e]);return Object.keys(a).length>0?o.where=[a]:delete o.where,o};export{decodeQueryParams,getContentQuery};
//# sourceMappingURL=query.mjs.map
